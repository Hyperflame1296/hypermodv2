function mixin(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function EventEmitter(){this._events={}}function hashFnv32a(t,e,n){var s,i,a=void 0===n?2166136261:n;for(s=0,i=t.length;s<i;s++)a^=t.charCodeAt(s),a+=(a<<1)+(a<<4)+(a<<7)+(a<<8)+(a<<24);return e?("0000000"+(a>>>0).toString(16)).substr(-8):a>>>0}function round(t,e,n){return Math.round((t-n)/e)*e+n}EventEmitter.prototype.on=function(t,e){this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)},EventEmitter.prototype.off=function(t,e){if(this._events.hasOwnProperty(t)){var n=this._events[t].indexOf(e);n<0||this._events[t].splice(n,1)}},EventEmitter.prototype.emit=function(t){if(this._events.hasOwnProperty(t)){var e=this._events[t].slice(0);if(!(e.length<1))for(var n=Array.prototype.slice.call(arguments,1),s=0;s<e.length;s++)e[s].apply(this,n)}};var Knob=function(t,e,n,s,i,a,r){EventEmitter.call(this),this.min=e||0,this.max=n||10,this.step=s||.01,this.value=i||this.min,this.knobValue=(this.value-this.min)/(this.max-this.min),this.name=a||"",this.unit=r||"";var o=s.toString().indexOf(".");-1==o&&(o=s.toString().length-1),this.fixedPoint=s.toString().substr(o).length-1,this.dragY=0,this.mouse_over=!1,this.canvas=t,this.ctx=t.getContext("2d"),this.radius=.3333*this.canvas.width,this.baseImage=document.createElement("canvas"),this.baseImage.width=t.width,this.baseImage.height=t.height;var h=this.baseImage.getContext("2d");h.fillStyle="#444",h.shadowColor="rgba(0, 0, 0, 0.5)",h.shadowBlur=5,h.shadowOffsetX=.02*this.canvas.width,h.shadowOffsetY=.02*this.canvas.width,h.beginPath(),h.arc(this.canvas.width/2,this.canvas.height/2,this.radius,0,2*Math.PI),h.fill();var l=this,d=!1;function c(){var t=document.getElementById("tooltip");if(!t){t=document.createElement("div"),document.body.appendChild(t),t.id="tooltip";var e=l.canvas.getBoundingClientRect();t.style.left=e.left+"px",t.style.top=e.bottom+"px"}t.textContent=l.name,l.name&&(t.textContent+=": "),t.textContent+=l.valueString()+l.unit}function u(){var t=document.getElementById("tooltip");t&&t.parentElement.removeChild(t)}!function(){function e(t){if(t.screenY!==l.dragY){var e=-(t.screenY-l.dragY),n=.0075;t.ctrlKey&&(n*=.05),l.setKnobValue(l.knobValue+e*n),l.dragY=t.screenY,l.redraw()}t.preventDefault(),c()}function n(t){null===t.toElement&&null===t.relatedTarget&&s()}function s(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseout",n),document.removeEventListener("mouseup",s),l.emit("release",l),d=!1,l.mouse_over||u()}t.addEventListener("mousedown",function(t){var i=l.translateMouseEvent(t);l.contains(i.x,i.y)&&(d=!0,l.dragY=t.screenY,c(),document.addEventListener("mousemove",e),document.addEventListener("mouseout",n),document.addEventListener("mouseup",s))}),t.addEventListener("keydown",function(t){38==t.keyCode?(l.setValue(l.value+l.step),c()):40==t.keyCode&&(l.setValue(l.value-l.step),c())})}(),l.canvas.addEventListener("mousemove",function(t){var e=l.translateMouseEvent(t);l.contains(e.x,e.y)?(l.mouse_over=!0,c()):(l.mouse_over=!1,d||u())}),l.canvas.addEventListener("mouseout",function(t){l.mouse_over=!1,d||u()}),this.redraw()};mixin(Knob.prototype,EventEmitter.prototype),Knob.prototype.redraw=function(){var t=.28*this.canvas.width,e=.03*this.canvas.width;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.baseImage,0,0);var n=this.knobValue;n*=2*Math.PI*.8,n+=Math.PI/2,n+=2*Math.PI*.1;var s=this.canvas.width/2,i=Math.cos(n)*t+s,a=Math.sin(n)*t+s;this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.arc(i,a,e,0,2*Math.PI),this.ctx.fill()},Knob.prototype.setKnobValue=function(t){t<0?t=0:t>1&&(t=1),this.knobValue=t,this.setValue(t*(this.max-this.min)+this.min)},Knob.prototype.setValue=function(t){(t=round(t,this.step,this.min))<this.min?t=this.min:t>this.max&&(t=this.max),this.value!==t&&(this.value=t,this.knobValue=(t-this.min)/(this.max-this.min),this.redraw(),this.emit("change",this))},Knob.prototype.valueString=function(){return this.value.toFixed(this.fixedPoint)},Knob.prototype.contains=function(t,e){return t-=this.canvas.width/2,e-=this.canvas.height/2,Math.sqrt(Math.pow(t,2)+Math.pow(e,2))<this.radius},Knob.prototype.translateMouseEvent=function(t){var e=t.target;return{x:t.clientX-e.getBoundingClientRect().left-e.clientLeft+e.scrollLeft,y:t.clientY-(e.getBoundingClientRect().top-e.clientTop+e.scrollTop)}};const url_regex=new RegExp("(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?","ig"),parseContent=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),markdownRegex=/((?:\\|)(?:\|\|.+?\|\||```.+?```|``.+?``|`.+?`|\*\*\*.+?\*\*\*|\*\*.+?\*\*|\*.+?\*|___.+?___|__.+?__|_.+?_(?:\s|$)|~~.+?~~))/g,getTextContent=t=>t.indexOf(">")>-1&&t.indexOf("</")>-1&&t.slice(t.indexOf(">")+1,t.lastIndexOf("</"))||t,getLinkTextContent=t=>{const e=t.indexOf(">"),n=t.lastIndexOf("</"),s=e>n?-1:e;return(s>-1||n>-1)&&t.slice(s>-1?s+1:0,n>-1?n:t.length)||t},parseUrl=t=>t.replace(url_regex,t=>{const e=getLinkTextContent(t);return`<a rel="noreferer noopener" target="_blank" class="chatLink" href="${e}">${e}</a>`}),parseMarkdown=(t,e=t=>t)=>t.split(markdownRegex).map(t=>{const n=t.endsWith("~~"),s=t.endsWith("___"),i=t.endsWith("__"),a=t.endsWith("_"),r=t.endsWith("***"),o=t.endsWith("**"),h=t.endsWith("*"),l=t.endsWith("```"),d=t.endsWith("``"),c=t.endsWith("`"),u=t.endsWith("||");if(t.startsWith("\\~~")&&n||t.startsWith("\\___")&&s||t.startsWith("\\__")&&i||t.startsWith("\\_")&&a||t.startsWith("\\***")&&r||t.startsWith("\\**")&&o||t.startsWith("\\*")&&h||t.startsWith("\\```")&&l||t.startsWith("\\``")&&d||t.startsWith("\\`")&&c||t.startsWith("\\||")&&u)return e(t.slice(1));if(t.startsWith("~~")&&n){const n=parseMarkdown(getTextContent(t.slice(2,t.length-2)),e);return n.trim().length<1?t:`<del class="markdown">${n}</del>`}if(t.startsWith("___")&&s){const n=parseMarkdown(getTextContent(t.slice(3,t.length-3)),e);return n.trim().length<1?t:`<em class="markdown"><u class="markdown">${n}</u></em>`}if(t.startsWith("__")&&i){const n=parseMarkdown(getTextContent(t.slice(2,t.length-2)),e);return n.trim().length<1?t:`<u class="markdown">${n}</u>`}if(t.startsWith("***")&&r){const n=parseMarkdown(getTextContent(t.slice(3,t.length-3)),e);return n.trim().length<1?t:`<em class="markdown"><strong class="markdown">${n}</strong></em>`}if(t.startsWith("**")&&o){const n=parseMarkdown(getTextContent(t.slice(2,t.length-2)),e);return n.trim().length<1?t:`<strong class="markdown">${n}</strong>`}if(t.startsWith("*")&&h||t.startsWith("_")&&a){const n=parseMarkdown(getTextContent(t.slice(1,t.length-1)),e);return n.trim().length<1?t:`<em class="markdown">${n}</em>`}if(t.startsWith("`")&&c){const e=t.startsWith("```")&&l?3:t.startsWith("``")&&d?2:1,n=getTextContent(t.slice(e,t.length-e));return n.trim().length<1?t:`<code class="markdown">${n}</code>`}if(t.startsWith("||")&&u){const n=parseMarkdown(getTextContent(t.slice(2,t.length-2)),e);return n.trim().length<1?t:`<span class="markdown spoiler">${n}</span>`}return e(t)}).join("");