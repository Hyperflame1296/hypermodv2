class NoteQuota{static PARAMS_LOBBY={allowance:200,max:600,maxHistLen:3};static PARAMS_NORMAL={allowance:400,max:1200,maxHistLen:3};static PARAMS_RIDICULOUS={allowance:600,max:1800,maxHistLen:3};static PARAMS_OFFLINE={allowance:8e3,max:24e3,maxHistLen:3};static PARAMS_UNLIMITED={allowance:1e6,max:3e6,maxHistLen:3};static PARAMS_INFINITE={allowance:1/0,max:1/0,maxHistLen:3};#t=0;#a=0;#e=0;#s=0;#i=0;#n=!1;#c(t){const a=t-this.#i,e=a>0?a*this.#e:0;return Math.min(this.#t+e,this.max)}constructor(t,a){this.cb=t,this.max=0,this.CACHE_DURATION_MS=10,this.setParams(a)}get points(){const t=Date.now();if(this.#s>0&&t-this.#s<this.CACHE_DURATION_MS)return this.#a;const a=this.#c(t);return this.#a=a,this.#s=t,a}getParams(){return{m:"nq",allowance:this.max/3,max:this.max,maxHistLen:3}}setParams(t){const a=(t=t||NoteQuota.PARAMS_OFFLINE).max||this.max||NoteQuota.PARAMS_OFFLINE.max;return a!==this.max&&(this.max=a,this.#e=a/6e3,this.resetPoints(),!0)}resetPoints(){this.#t=this.max,this.#i=Date.now(),this.#s=0,this.cb&&this.cb(this.points)}spend(t){const a=Date.now(),e=this.#c(a);return!(e<t)&&(this.#t=e-t,this.#i=a,this.#a=this.#t,this.#s=a,this.cb&&this.cb(this.#t),!0)}tick(){this.#n||(console.warn("NoteQuota#tick() is deprecated and no longer has any effect. You can safely remove the timer to improve performance."),this.#n=!0)}get allowance(){return this.max/3}get maxHistLen(){return 3}get history(){const t=this.points;return[t,t,t]}}"undefined"!=typeof module?module.exports=NoteQuota:globalThis.NoteQuota=NoteQuota;